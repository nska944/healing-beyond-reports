<!DOCTYPE html>
<html>
<head>
  <title>Healing Beyond Reports</title>
  <link rel="stylesheet" href="/static/style.css">

  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
</head>

<body class="centered">

<div class="login-card">
  <h1>Healing Beyond Reports</h1>

  <p class="subtitle">
    AI-assisted Personal Health Record<br>
    using Machine Learning & NLP
  </p>

  <button class="google-btn" onclick="loginWithGoogle()">
    Sign in with Google
  </button>

  <form id="tokenForm" method="POST" action="/firebase_login">
    <input type="hidden" name="idToken" id="idToken">
  </form>
</div>

<script>
  const firebaseConfig = {
  apiKey: "AIzaSyBx8wgb2-gdv8kzQOHn3DRUkZEEErVCn3Y",
  authDomain: "meditrace-ai.firebaseapp.com",
  projectId: "meditrace-ai",
  appId: "1:432950812332:web:51746650fdbba964b3c909"
};
  firebase.initializeApp(firebaseConfig);

  function loginWithGoogle() {
    const provider = new firebase.auth.GoogleAuthProvider();
    firebase.auth().signInWithPopup(provider)
      .then(res => res.user.getIdToken())
      .then(token => {
        document.getElementById("idToken").value = token;
        document.getElementById("tokenForm").submit();
      })
      .catch(() => firebase.auth().signInWithRedirect(provider));
  }

  firebase.auth().getRedirectResult().then(res => {
    if (res.user) {
      return res.user.getIdToken();
    }
  }).then(token => {
    if (token) {
      document.getElementById("idToken").value = token;
      document.getElementById("tokenForm").submit();
    }
  });
</script>

</body>
</html>
